
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChID's Python Compiler | by Chidambaram Saravanan</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.12/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.12/theme/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.12/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.12/mode/python/python.min.js"></script>

    <style>
        :root {
            --idle-blue: #2e71ff;
            --idle-red: #ff3333;
            --header-bg: #2c3e50;
            --btn-green: #27ae60;
            --btn-blue: #2980b9;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1e1e1e;
            color: white;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        header {
            background: var(--header-bg);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #f1c40f;
            text-shadow: 1px 1px 2px black;
        }

        .controls {
            display: flex;
            gap: 10px;
        }

        button {
            padding: 8px 20px;
            border: none;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
        }

        .run-btn { background-color: var(--btn-green); }
        .run-btn:hover { background-color: #2ecc71; transform: scale(1.05); }

        .clear-btn { background-color: #7f8c8d; }
        .clear-btn:hover { background-color: #95a5a6; }

        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* Code Editor Section */
        .editor-box {
            flex: 1.2;
            border-right: 2px solid #333;
            font-size: 16px;
        }

        .CodeMirror {
            height: 100% !important;
        }

        /* Right Side: Input & Output */
        .io-panel {
            flex: 0.8;
            display: flex;
            flex-direction: column;
            background-color: #ffffff; /* White background like IDLE Shell */
        }

        .section-label {
            background: #f0f0f0;
            color: #333;
            padding: 5px 15px;
            font-size: 12px;
            font-weight: bold;
            border-bottom: 1px solid #ddd;
        }

        #userInput {
            height: 150px;
            border: none;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 14px;
            outline: none;
            background: #f9f9f9;
            color: #333;
            resize: none;
        }

        #outputBox {
            flex: 1;
            padding: 15px;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 15px;
            overflow-y: auto;
            white-space: pre-wrap; /* Preserves consecutive lines/newlines */
            color: #000;
        }

        .status-bar {
            background: #333;
            padding: 5px 20px;
            font-size: 12px;
            color: #aaa;
        }
    </style>
</head>
<body>

<header>
    <div class="logo">ChID's Python Compiler</div>
    <div class="author-tag">By Chidambaram Saravanan</div>
    <div class="controls">
        <button class="clear-btn" onclick="clearConsole()">Clear Shell</button>
        <button class="run-btn" onclick="runCode()">Run Module (F5)</button>
    </div>
</header>

<div class="main-container">
    <div class="editor-box">
        <textarea id="codeEditor"># Type your code here
print("Hello ChID!")
name = input("Enter name: ")
print("Welcome,", name)

for i in range(3):
    print(f"Counting: {i}")</textarea>
    </div>

    <div class="io-panel">
        <div class="section-label">STDIN (Input values here before Running)</div>
        <textarea id="userInput" placeholder="Example:
ChID"></textarea>
        
        <div class="section-label">PYTHON SHELL (Output)</div>
        <div id="outputBox">>>> </div>
    </div>
</div>

<div class="status-bar" id="statusBar">Ready</div>

<script>
    // Initialize CodeMirror
    var editor = CodeMirror.fromTextArea(document.getElementById("codeEditor"), {
        mode: "python",
        theme: "monokai",
        lineNumbers: true,
        indentUnit: 4,
        smartIndent: true,
        autoCloseBrackets: true,
        matchBrackets: true
    });

    // Handle Keyboard Shortcut (F5 to run)
    window.addEventListener('keydown', function(e) {
        if (e.key === "F5") {
            e.preventDefault();
            runCode();
        }
    });

    function clearConsole() {
        document.getElementById("outputBox").innerHTML = ">>> ";
        document.getElementById("statusBar").innerText = "Console Cleared";
    }

    async function runCode() {
        const code = editor.getValue();
        const stdin = document.getElementById("userInput").value;
        const outputBox = document.getElementById("outputBox");
        const statusBar = document.getElementById("statusBar");

        statusBar.innerText = "Running...";
        statusBar.style.color = "#f1c40f";

        try {
            const response = await fetch('https://emkc.org/api/v2/piston/execute', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    language: "python",
                    version: "3.10.0",
                    files: [{ content: code }],
                    stdin: stdin
                })
            });

            const result = await response.json();
            
            // IDLE Logic: Error = Red, Success = Blue
            if (result.run.stderr) {
                outputBox.innerHTML += `<span style="color: var(--idle-red);">${result.run.stderr}</span>`;
            } else {
                outputBox.innerHTML += `<span style="color: var(--idle-blue);">${result.run.output}</span>`;
            }
            
            outputBox.innerHTML += ">>> ";
            outputBox.scrollTop = outputBox.scrollHeight; // Auto-scroll to bottom
            statusBar.innerText = "Execution Finished";
            statusBar.style.color = "#2ecc71";

        } catch (error) {
            outputBox.innerHTML += `<span style="color: red;">\nConnection Error: Could not reach compiler server.</span>\n>>> `;
            statusBar.innerText = "Error";
        }
    }
</script>

</body>

</html>
